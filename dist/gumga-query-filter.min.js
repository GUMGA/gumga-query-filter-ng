!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";n(3),n(4),angular.module("gumga.queryfilter.factory",["gumga.queryfilter.factory.hql","gumga.queryfilter.factory.querymodel"])},function(e,t,n){"use strict";n(6),n(5),angular.module("gumga.queryfilter.filter",["gumga.queryfilter.filter.directive","gumga.queryfilter.filter.core"])},function(e,t,n){"use strict";function a(e,t,n,a){function r(r,l,i,o){function u(){var e='<gumga-filter-core ng-show="openFilter" is-open="true" search="ctrl.proxySearch(param)" '+(i.saveQuery?'save-query="saveQuery(query, name)"':"")+'is-query="true">'+p.possibleAdvancedFields.reduce(function(e,t){return e+=t},"")+"</gumga-filter-core>";angular.element(document.getElementById(p.containerAdvanced)).replaceWith(n(e)(r))}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keyCode:13},n=arguments[2];if(13===t.keyCode&&"TYPEAHEAD"!=n){var a=Object.keys(p.mapFields).filter(function(e){return!!p.mapFields[e].checkbox}).reduce(function(e,t){return e+=t.concat(",")},"").slice(0,-1);0!==a.length&&p.search({field:a,param:e})}}function s(t){return e.when(p.savedFilters({page:location.hash}))}function d(e,n,a,l){t(function(){return p.searchField="",r.$broadcast("filter-items",e)})}var p=this,v=function(e){return!!i[e]};p.mapFields={},p.possibleAdvancedFields=[],v("search")||console.error('É necessário passar uma função para o atributo "search". [search="foo(field, param)"]'),o(function(e){var t=!1,n=r.$parent;if([].slice.call(e).forEach(function(e){if(e&&"ADVANCED-SEARCH-FIELD"===e.nodeName&&p.possibleAdvancedFields.push(e.outerHTML),e&&"SEARCH-FIELD"===e.nodeName){var l=angular.element(e),i=l.attr("field")?l.attr("field"):"",o=!!r.$eval(l.attr("select")),u=l.attr("label")?a(l.attr("label"))(n):i.charAt(0).toUpperCase().concat(i.slice(1));i||console.error('É necessário um parâmetro field na tag search-field.[<search-field field="foo"></search-field>]'),o&&(t=!0),p.mapFields[i]={checkbox:o,label:u,field:i}}}),!t){for(var l in p.mapFields)break;l&&(p.mapFields[l].checkbox=!0)}}),p.$onInit=function(){p.compileFilter=u,p.doSearch=c,p.proxyFn=s,p.filterSelect=d,p.advancedSearch=v("advancedSearch")?p.advancedSearch:null,p.containerAdvanced=v("containerAdvanced")?p.containerAdvanced:"replaceFilter",p.savedFilters=v("savedFilters")?p.savedFilters:angular.noop,p.searchText=v("searchText")?i.searchText:" ",p.proxySearch=function(e){return p.advancedSearch({param:e})},p.hasQuerySaved=!!i.savedFilters,r.proxySave=function(e,t){return p.saveQuery({query:e,name:t})},p.advancedSearch&&p.compileFilter()},r.$watch("openFilter",function(e){void 0!==e&&r.$broadcast("openOrCloseFilter",e)}),p.checkFields=function(e,t){var n=Object.keys(p.mapFields).filter(function(e){return!!p.mapFields[e].checkbox});(1==n.length&&n[0]==t||1==Object.keys(p.mapFields).length)&&e.preventDefault(),e.stopPropagation()}}return r.$inject=["$scope","$element","$attrs","$transclude"],{restrict:"E",scope:{search:"&",advancedSearch:"&?",containerAdvanced:"@?",savedFilters:"&?",saveQuery:"&?"},bindToController:!0,transclude:!0,controllerAs:"ctrl",controller:r,template:'\n     <div class="input-group">\n        <input type="text" placeholder="Busque seus filtros salvos" class="form-control" ng-model="ctrl.searchField" ng-keyup="ctrl.doSearch(ctrl.searchField, $event, \'TYPEAHEAD\')" uib-typeahead="item.description for item in ctrl.proxyFn($viewValue)" typeahead-on-select="ctrl.filterSelect($item, $model, $label, $event)" ng-show="ctrl.hasQuerySaved && openFilter"/>\n        <input type="text" class="form-control" ng-model="ctrl.searchField" ng-keyup="ctrl.doSearch(ctrl.searchField, $event)" ng-show="!ctrl.hasQuerySaved || !openFilter" />\n        <span class="input-group-btn" uib-dropdown uib-keyboard-nav auto-close="outsideClick">\n          <button class="btn btn-default" type="button" uib-dropdown-toggle>\n            <span class="glyphicon glyphicon-chevron-down"><span>\n          </button>\n          <ul uib-dropdown-menu role="menu" aria-labelledby="single-button" class="dropdown-menu-search">\n            <li role="menuitem" ng-repeat="(key, $value) in ctrl.mapFields">\n              <a class="no-padding-search-fields">\n                <label ng-click="ctrl.checkFields($event, $value.field)">\n                  <input type="checkbox" ng-model="$value.checkbox" />\n                  {{::$value.label}}\n                </label>\n              </a>\n            </li>\n          </ul>\n          <button class="btn btn-default" ng-click="openFilter = !openFilter" type="button">\n            <span class="glyphicon glyphicon-filter"></span>\n          </button>\n          <button class="btn btn-primary" type="button" ng-click="ctrl.doSearch(ctrl.searchField)">\n            <span> {{::ctrl.searchText}} </span>\n            <span class="glyphicon glyphicon-search rotate-search-glyph"></span>\n          </button>\n        </span>\n      </div>\n      <div class="row replace-filter">\n        <div class="col-md-12">\n          <div id="replaceFilter"></div>\n        </div>\n      </div>'}}a.$inject=["$q","$timeout","$compile","$interpolate"],angular.module("gumga.queryfilter.query",[]).directive("gumgaQuery",a)},function(e,t,n){"use strict";function a(e){function t(e){return p[e]||null}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.contains={hql:" contains ",label:" contém ",before:" like upper('%",after:"%')"},t.not_contains={hql:" not_contains ",label:" não contém ",before:" not like upper('%",after:"%')"},t.starts_with={hql:" starts_with ",label:" começa com ",before:" like upper('",after:"%')"},t.ends_with={hql:" ends_with ",label:" termina com ",before:" like upper('%",after:"')"},t.eq={hql:" eq ",label:" igual ",before:" = upper('",after:"')"},t.ne={hql:" ne ",label:" diferente de ",before:" != upper('",after:"')"},t.ge={hql:" ge ",label:" maior igual ",before:" >= upper('",after:"')"},t.gt={hql:" gt ",label:" maior que ",before:" >   ",after:""},t.le={hql:" le ",label:" menor igual ",before:" <=  ",after:""},t.lt={hql:" lt ",label:" menor que ",before:" < upper('",after:"')"},t.in={hql:" in ",label:" em",before:" in (",after:")"},t.is={hql:" is ",label:" está ",before:" is ",after:""},t.date_eq={hql:" eq ",label:" igual ",before:" >= ",after:""},t.date_ne={hql:" ne ",label:" diferente de ",before:" <= ",after:""},t.date_lt={hql:" ld ",label:" anterior a ",before:" <= ",after:""},t.date_gt={hql:" gd ",label:" posterior a ",before:" >= ",after:""},e.map(function(e){return t[e]})}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=Object.keys(e).filter(function(t){return e[t].active&&e[t].query.value}).map(function(n){var a="obj.".concat(e[n].query.attribute?e[n].query.attribute.field:"*"),r=e[n].query.condition?e[n].query.condition.before:"*",l=e[n].query.value.replace?e[n].query.value.replace(/'/g,"''"):e[n].query.value,i=e[n].query.condition?e[n].query.condition.after:"*";if(e[n].query.attribute)switch(e[n].query.attribute.type){case"date":var o=l.split("");l=""+o[4]+o[5]+o[6]+o[7]+"-"+o[2]+o[3]+"-"+o[0]+o[1];var u="to_timestamp('"+l+" 00:00:00','yyyy/MM/dd HH24:mi:ss')",c="to_timestamp('"+l+" 23:59:59','yyyy/MM/dd HH24:mi:ss')";switch(e[n].query.condition.hql){case" eq ":l=u+" AND "+a+" <= "+c;break;case" ne ":l=u+" OR "+a+" >= "+c;break;case" ld ":l=c;break;case" gd ":l=u}l=l;break;case"enum":l="'"+e[n].query.value.join("','")+"'";break;case"number":case"float":case"money":r=r.replace(/'/g,""),i=i.replace(/'/g,"");break;case"string":case"cpf":case"cnpj":a="upper("+a+")"}return t.push({attribute:e[n].query.attribute,condition:e[n].query.condition,value:e[n].query.value.replace?e[n].query.value.replace(/'/g,"''"):e[n].query.value}),a.concat(r).concat(l).concat(i).replace(/obj.\*/g,"").replace(/\*/g,"")}).filter(function(e,t,n){var a=["OR","AND"];if(-1===a.indexOf(e))return!0;var r=n[t-1],l=n[t+1];return void 0!==r&&-1===a.indexOf(r)&&void 0!==l&&-1===a.indexOf(l)}).join(" ");return"ND"===n.slice(-2)||"OR"===n.slice(-2)?(t.pop(),{hql:n.slice(0,-3),source:JSON.stringify(t)}):n?{hql:n,source:JSON.stringify(t)}:{}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";return p[e]?p[e].validator:angular.noop}var l=/[0-9]{3}\.[0-9]{3}\.[0-9]{3}\-[0-9]{2}/,i=/[0-9]{2}\.?[0-9]{3}\.?[0-9]{3}\/?[0-9]{4}\-?[0-9]{2}/,o=/[0-9]{2}\/[0-9]{2}\/[0-9]{4}/,u=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,c=/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/,s=/^[0-9]+$/,d=/^[0-9]+(\.[0-9]{1,2})?$/,p={};p.string={validator:function(e){return"string"==typeof e||e instanceof String},defaultCondition:n(["contains"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                  <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" required autofocus style=" width: 150px;height: 40px;" />\n                  <div class="input-group-addon">\n                      <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                      <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                  </div>\n                  <div class="input-group-addon">\n                      <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                  </div>\n              </div>'},p.number={validator:function(e){return s.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","gt","ge","lt","le"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" gumga-number required style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value)" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value)" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')"  class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.float={validator:function(e){return d.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","gt","ge","lt","le"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" gumga-number required style=" width: 150px;height: 40px;"/>                    \n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value)" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value)" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.money={validator:function(e){return d.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","gt","ge","lt","le"]),template:'<div class="input-group">\n                    <input ng-keyup="goSearch($event)" type="text" ng-model="$value.query.value" gumga-mask="R$ " class="form-control" gumga-number required style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value)" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value)" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.cpf={validator:function(e){return l.test(v.toCpf(e))},defaultCondition:n(["eq"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" gumga-mask="999.999.999.99" class="form-control" required style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.cnpj={validator:function(e){return i.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" gumga-mask="99.999.999/9999-99" class="form-control" required style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.boolean={validator:function(e){return"true"==e||"false"==e},defaultCondition:n(["is"]),conditions:n(["is"]),template:' <div class="radio"><label><input  type="radio" ng-model="$value.query.value" value="true"> {{$value.query.attribute.extraProperties.trueLabel}}</label></div><div class="radio"><label><input type="radio" ng-model="$value.query.value" value="false"> {{$value.query.attribute.extraProperties.falseLabel}} </label></div>'},p.date={validator:function(t){return o.test(e("date")(t,"dd/MM/yyyy"))},defaultCondition:n(["date_eq"]),conditions:n(["date_eq","date_ne","date_lt","date_gt"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" gumga-mask="99/99/9999" class="form-control" required  style=" width: 150px;height: 40px;"/>\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.select={validator:function(e){return!!e},defaultCondition:n(["eq"]),conditions:n(["eq","ne"]),template:'<select ng-model="$value.query.value" ng-options="d.field as d.label for d in $value.query.attribute.extraProperties.data track by d.field" class="form-control" required /></select>'},p.enum={validator:function(e){return Array.isArray(e)},defaultCondition:n(["in"]),conditions:n(["in"]),template:'<div class="col-md-4" ng-class="{\'row\': $index % 3 == 0}" ng-repeat="d in $value.query.attribute.extraProperties.data"><label><input type="checkbox" ng-checked="$value.query.value.indexOf(d.field) > -1" ng-click="toggleEnum($event, $key, d.field)"></label> {{d.label}}</div>'},p.email={validator:function(e){return"string"==typeof e||e instanceof String},defaultCondition:n(["eq"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" required  style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.url={validator:function(e){return u.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                    <input type="url" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" required  style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'},p.ip={validator:function(e){return c.test(e)},defaultCondition:n(["eq"]),conditions:n(["eq","ne","contains","not_contains","starts_with","ends_with"]),template:'<div class="input-group">\n                    <input type="text" ng-keyup="goSearch($event)" ng-model="$value.query.value" class="form-control" required style=" width: 150px;height: 40px;" />\n                    <div class="input-group-addon">\n                        <i ng-show="validator($value.query.value) && $value.query.value.length > 0" class="glyphicon glyphicon-ok" style="color:green"></i></span>\n                        <i ng-show="!validator($value.query.value) || !$value.query.value" class="glyphicon glyphicon-remove" style="color:red"></i>\n                    </div>\n                    <div class="input-group-addon">\n                        <button ng-click="callSearch($event, \'btn\')" class="btn btn-default">Buscar</button>\n                    </div>\n              </div>'};var v={toCpf:function(e){return(e+"").replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2")}};return{useType:t,hqlObjectCreator:n,createHql:a,validator:r}}a.$inject=["$filter"],angular.module("gumga.queryfilter.factory.hql",[]).factory("HQLFactory",a)},function(e,t,n){"use strict";function a(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NOTHING",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:999;this.STATES=Object.freeze({NOTHING:1,ONLY_ATTRIBUTE:2,ATTRIBUTE_AND_CONDITION:4,EVERYTHING_NEEDED:8,UPDATING_ATTRIBUTE:16,UPDATING_CONDITION:32,UPDATING_VALUE:64}),this.query=e,this.active=t,this.activeStates=this.STATES[n],this.zIndex=a}return e.prototype.addState=function(e){return this.activeStates|=this.STATES[e],this},e.prototype.removeState=function(e){return this.activeStates&=~this.STATES[e],this},e.prototype.isNOTHING=function(){return 0!=(this.activeStates&this.STATES.NOTHING)},e.prototype.isONLY_ATTRIBUTE=function(){return 0!=(this.activeStates&this.STATES.ONLY_ATTRIBUTE)},e.prototype.isATTRIBUTE_AND_CONDITION=function(){return 0!=(this.activeStates&this.STATES.ATTRIBUTE_AND_CONDITION)},e.prototype.isEVERYTHING_NEEDED=function(){return 0!=(this.activeStates&this.STATES.EVERYTHING_NEEDED)},e.prototype.isUPDATING_ATTRIBUTE=function(){return 0!=(this.activeStates&this.STATES.UPDATING_ATTRIBUTE)},e.prototype.isUPDATING_CONDITION=function(){return 0!=(this.activeStates&this.STATES.UPDATING_CONDITION)},e.prototype.isUPDATING_VALUE=function(){return 0!=(this.activeStates&this.STATES.UPDATING_VALUE)},e.prototype.isBeingUpdated=function(){return this.isUPDATING_VALUE()},{create:function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];return new(Function.prototype.bind.apply(e,[null].concat(n)))}}}a.$inject=[],angular.module("gumga.queryfilter.factory.querymodel",[]).factory("QueryModelFactory",a)},function(e,t,n){"use strict";function a(e,t,n,a,r,l){return{restrict:"E",template:'\n        <style>\n          .gumga-filter .dropdown-menu > li > a {\n            cursor: pointer;\n          }\n          .gumga-filter .panel-body .input-group-btn {\n            border: 1px solid #ccc;\n            border-left-width: 2px;\n            border-right-width: 2px;\n            border-radius: 4px;\n          }\n          .gumga-filter .panel-body .input-group-btn .btn {\n            border-color: transparent;\n            border-radius: 4px;\n            border: 1px;\n          }\n          .gumga-filter .panel-body .btn,\n          .gumga-filter .panel-body .input-group-btn .btn {\n            padding: 3px 6px;\n          }\n          .gumga-filter-panel {\n            position: absolute;\n            top: 100%;\n            left: 0;\n            z-index: 1000;\n            display: none;\n            float: left;\n            min-width: 160px;\n            padding: 12px;\n            margin: 2px 0 0;\n            font-size: 14px;\n            text-align: left;\n            background-color: #fff;\n            border: 1px solid #ccc;\n            border: 1px solid rgba(0,0,0,.15);\n            border-radius: 4px;\n            box-shadow: 0 6px 12px rgba(0,0,0,.175);\n            background-clip: padding-box;\n          }\n          .gumga-filter-panel .dropdown-menu li {\n            z-index: 3000;\n            position: absolute;\n            top: 100%;\n            left: 0;\n            z-index: 1000;\n            display: none;\n            float: left;\n            min-width: 160px;\n            padding: 12px;\n            margin: 2px 0 0;\n            font-size: 14px;\n            text-align: left;\n            background-color: #fff;\n            border: 1px solid #ccc;\n            border: 1px solid rgba(0,0,0,.15);\n            border-radius: 4px;\n            box-shadow: 0 6px 12px rgba(0,0,0,.175);\n            background:-clip padding-box;\n          }\n          gumga-filter .panel.heading {\n            padding: 5px 10px;\n          }\n          gumga-filter .form-inline.panel-body .input-group {\n            margin-right: 5px;\n          }\n          gumga-filter .form-inline.panel-body .input-group-btn > button,\n          gumga-filter .form-inline.panel-body .input-group-btn > btn-group > button[uib-dropdown-toggle] {\n            z-index: 0;\n          }\n          gumga-filter .form-inline.panel-body .input-group-btn > btn-group > ul[uib-dropdown-menu],\n          gumga-filter .form-inline.panel-body .input-group-btn > btn-group > ul[uib-dropdown-menu] > li {\n            z-index: 3000;\n          }\n          gumga-filter .btn-group.dropdown .glyphicon {\n            top: 3px;\n          }\n          gumga-query .row.replace-filter {\n            margin-top: .5%;\n          }\n        </style>\n        <div class="gumga-filter panel panel-default" >\n            <header class="panel-heading" style="padding: 5px 10px;">\n                <div class="row">\n                    <div class="col-md-8 col-xs-7">\n                        <h5>Pesquisa avançada <strong ng-if="filterSelectItem"> - {{filterSelectItem.description}}</strong></h5>\n                    </div>\n                    <div class="col-md-4 col-xs-5" ng-show="saveQuery">\n                        <div class="input-group" >\n                            <input type="text" ng-model="nameSearch" class="form-control" id="_save" ng-show="saveFilterOpen" ng-keyup="saveSearch(nameSearch, $event)" ng-blur="closeInput()">\n                            <div class="input-group-btn">\n                                <button class="btn btn-success" ng-show="saveFilterOpen" ng-click="saveSearch(nameSearcht)" ng-disabled="!nameSearch">\n                                    <i class="glyphicon glyphicon-floppy-saved"></i>\n                                </button>\n                                <button class="btn btn-default pull-right" type="button" ng-hide="saveFilterOpen" ng-click="showInput()" ng-disabled="!isAnyQueryNotOk()">\n                                    <i class="glyphicon glyphicon-floppy-disk"></i>\n                                </button>\n                                <button class="btn btn-default"  ng-click="deleteFilter(filterSelectItem.id)" ng-if="filterSelectItem" style="float: right;margin-right: 15px;">\n                                    <i class="glyphicon glyphicon-floppy-remove"></i>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </header>\n            <div class="form-inline panel-body">\n              <div class="row">\n                <div class="col-md-6">\n                  <h5><strong>Filtrar por:</strong></h5>\n                </div>\n                <div class="col-md-6">\n                  <button id="single-button" type="button" class="btn btn-default pull-right" ng-click="clearQuery()" ng-disabled="!isAnyQueryNotOk()" >\n                    <i class="glyphicon glyphicon-repeat"></i> Limpar filtros\n                  </button>\n                </div>\n              </div>\n              <div class="input-group" ng-repeat="($key, $value) in controlMap" style="margin-right: 1%;margin-top: 7.5px;z-index: {{$value.zIndex}}" ng-show="$value.active" id="first" >\n                  <div class="input-group-btn">\n                    <div class="btn-group" uib-dropdown ng-show="!$value.query.label" is-open="$value.isUPDATING_ATTRIBUTE()" auto-close="disabled">\n                      <button type="button" style="z-index: 0" class="btn btn-default" uib-dropdown-toggle ng-click="toggleUpdatingAttribute(this)" ng-disabled="$value.isUPDATING_VALUE() || $value.isUPDATING_CONDITION() || (!isAnyQueryNotOk() && $value.isEVERYTHING_NEEDED()) ">\n                        <span> {{ $value.query.attribute.label || \'Atributo\' }}  <i class="glyphicon glyphicon-chevron-down"></i></span>\n                      </button>\n                      <ul uib-dropdown-menu style="z-index: 3000" role="menu">\n                        <li style="z-index: 3000;" role="menuitem" ng-repeat="attribute in _attributes track by $index">\n                          <a ng-click="addAttribute(attribute, this.$parent, $key)">{{attribute.label}}</a>\n                        </li>\n                      </ul>\n                    </div>\n                    <div class="btn-group" uib-dropdown is-open="$value.isUPDATING_CONDITION()" ng-show="!$value.query.label" auto-close="disabled">\n                      <button type="button" class="btn btn-default" uib-dropdown-toggle ng-click="toggleUpdatingCondition(this)" ng-disabled="$value.isUPDATING_VALUE() || $value.isUPDATING_ATTRIBUTE() || (!isAnyQueryNotOk() && $value.isEVERYTHING_NEEDED()) || $value.isNOTHING()">\n                          <span>{{ $value.query.condition.label || \'Condição\' }} <i class="glyphicon glyphicon-chevron-down"></i></span>\n                      </button>\n                      <ul uib-dropdown-menu role="menu" >\n                        <li role="menuitem" ng-repeat="condition in conditions track by $index">\n                          <a ng-click="addCondition(condition, this.$parent, $key)">{{condition.label}}</a>\n                        </li>\n                      </ul>\n                    </div>\n                    <div class="btn-group" id="_btnValue{{$key}}" ng-show="!$value.query.label">\n                      <button type="button" class="btn btn-default" ng-click="toggleUpdatingValue(this, $key)" ng-disabled="validatonValue($value)" id="_valueLabel{{$key}}">\n                          <span id="_conditionLabel{{$key}}">{{ getTextQuery($value) }} </span>\n                      </button>\n                      <div class="gumga-filter-panel" id="_panelValue{{$key}}"></div>\n                    </div>\n                    <div class="btn-group" ng-show="$value.query.label">\n                      <button type="button" class="btn btn-default" ng-click="updateOperator(this)" ng-disabled="!isAnyQueryNotOk()">\n                        <span> {{$value.query.label}} </span>\n                      </button>\n                    </div>\n                    <button type="button" style="z-index: 0;border-left: 1px solid #ccc; " class="btn btn-default" ng-click="removeQuery(this, $event, $index)" ng-show="!$value.query.label" ng-disabled="!$value.isEVERYTHING_NEEDED() || $value.isUPDATING_VALUE() ||(!isAnyQueryNotOk() && $value.isEVERYTHING_NEEDED()) ">\n                      <span class="glyphicon glyphicon-remove"></span>\n                    </button>\n                    </div>\n                  </div>\n                  <button id="single-button" type="button" class="btn btn-default" ng-click="addQuery()" ng-disabled="!isAnyQueryNotOk()" style="margin-top: 7.5px;" >\n                    <span class="glyphicon glyphicon-plus"></span>\n                  </button>\n                </div>\n              </div>\n            </div>\n        </div>',transclude:!0,scope:{search:"&",saveQuery:"&"},link:function(i,o,u,c,s){function d(t,a,r){a.$value.query.attribute=t,a.conditions=e.useType(t.type).conditions,a.validator=e.useType(t.type).validator,a.$value.removeState("UPDATING_ATTRIBUTE").removeState("NOTHING").addState("ONLY_ATTRIBUTE"),n(function(){a.$value.addState("UPDATING_CONDITION"),a.$value.isEVERYTHING_NEEDED()&&(a.$value.removeState("EVERYTHING_NEEDED"),a.$value.query.value="")})}function p(e){13==e.keyCode&&O(e)}function v(e){console.log(e)}function g(e){e.$value.isUPDATING_ATTRIBUTE()?e.$value.removeState("UPDATING_ATTRIBUTE"):e.$value.addState("UPDATING_ATTRIBUTE")}function y(t,a,r){a.$value.query.condition=t,a.$value.removeState("UPDATING_CONDITION").removeState("ONLY_ATTRIBUTE"),n(function(){a.$value.isEVERYTHING_NEEDED()?i.search({param:e.createHql(i.controlMap)}):(a.$value.removeState("ATTRIBUTE_AND_CONDITION").addState("UPDATING_VALUE"),b(r,a))})}function b(n,a){var r=C("_panelValue"+n);r.addClass("show"),"enum"==a.$value.query.attribute.type?r.attr("style","width: 500px"):"enum"!==a.$value.query.attribute.type&&r.attr("style")&&r.removeAttr("style"),t(r.html(e.useType(a.$value.query.attribute.type).template).contents())(a)}function f(e){e.$value.isUPDATING_CONDITION()?e.$value.removeState("UPDATING_CONDITION"):e.$value.addState("UPDATING_CONDITION")}function h(e,t){e.$value.isUPDATING_VALUE()?(e.$value.removeState("UPDATING_VALUE"),C("_panelValue"+t).addClass("show")):(e.$value.addState("UPDATING_VALUE"),C("_panelValue"+t).addClass("show"))}function m(){return 0===Object.keys(i.controlMap).filter(function(e){return!i.controlMap[e].isEVERYTHING_NEEDED()||i.controlMap[e].isUPDATING_ATTRIBUTE()||i.controlMap[e].isUPDATING_CONDITION()||i.controlMap[e].isUPDATING_VALUE()}).filter(function(e){return parseInt(e)%2==0}).length}function $(){return Object.keys(i.controlMap)[Object.keys(i.controlMap).length-1]}function q(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=angular.element(document.getElementById("first")).scope();t.$index!=e&&null!=t.$$nextSibling;)t=t.$$nextSibling;return t}function T(e){return e.isNOTHING()||e.isUPDATING_ATTRIBUTE()||e.isUPDATING_VALUE()||e.isUPDATING_CONDITION()||!(e.isEVERYTHING_NEEDED()||!e.isATTRIBUTE_AND_CONDITION())||!m()&&e.isEVERYTHING_NEEDED()}function E(e,t,n){e.stopPropagation();var a=C("_panelValue"+t).scope();Array.isArray(a.$value.query.value)||(a.$value.query.value=[]);var r=a.$value.query.value.indexOf(n);r>-1?a.$value.query.value.splice(r,1):a.$value.query.value.push(n)}function A(e){var t=void 0;switch(e.getAttribute("type")){case"boolean":t={trueLabel:e.getAttribute("true-label"),falseLabel:e.getAttribute("false-label")};break;case"select":t={data:w[e.getAttribute("data")]};break;case"enum":t={data:w[e.getAttribute("data")]}}return t}function N(){delete i.filterSelectItem,i.controlMap[parseInt($())+1]=r.create({value:"AND",label:"E"},void 0,"EVERYTHING_NEEDED",U--),i.controlMap[parseInt($())+1]=r.create({attribute:{},condition:{},value:""},void 0,"NOTHING",U--),n(function(){return q(parseInt($())).$value.addState("UPDATING_ATTRIBUTE")})}function I(){i.controlMap=[],F()}function S(){n(function(){i.saveFilterOpen=!1},200)}function x(){i.saveFilterOpen=!0,n(function(){return document.getElementById("_save").focus()})}function k(t,n){n&&13!=n.keyCode||(i.$parent.proxySave(e.createHql(i.controlMap),i.nameSearch),i.saveFilterOpen=!i.saveFilterOpen,i.nameSearch="")}function _(e,t,a){return delete i.filterSelectItem,e.$$prevSibling.$key||e.$$nextSibling?!e.$$prevSibling.$key&&e.$$nextSibling?(e.$value.active=!1,e.$$nextSibling.$value.active=!1,n(function(){return e.$$nextSibling.$destroy(),e.$destroy()}),void O(t,"remove",a)):void(e.$$prevSibling.$key&&(e.$value.active=!1,e.$$prevSibling.$value.active=!1,n(function(){return e.$$prevSibling.$destroy(),e.$destroy()}),O(t,"remove",a))):(e.$value.query={attribute:{},condition:{},value:""},e.$value.activeStates=0,n(function(){return e.$value.addState("UPDATING_ATTRIBUTE")}),void O(t,"remove",a))}function D(t){if("AND"===t.$value.query.value)return t.$value.query.value="OR",t.$value.query.label="OU",void i.search({param:e.createHql(i.controlMap)});t.$value.query.value="AND",t.$value.query.label="E",i.search({param:e.createHql(i.controlMap)})}function O(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,l=!0,o=Object.keys(i.controlMap).filter(function(e){return i.controlMap[e].isUPDATING_VALUE()})[0],u=void 0;if(t.target.id!="_conditionLabel"+o&&t.target.id!="_valueLabel"+o){if((t.target.id=="_panelValue"+o||function(e,t){for(var n=angular.element(e);0!=n.parent().length;n=n.parent())if(n[0].id=="_panelValue"+t){n=!0;break}return!0===n&&n}(t.target,o))&&(l=!1),i.controlMap[o]&&(u=e.validator(i.controlMap[o].query.attribute.type)),l&&u&&u(i.controlMap[o].query.value)||"keyup"==t.type||"btn"==a){var c=C("_panelValue"+o).scope();n(function(){return c.$value.removeState("UPDATING_VALUE").removeState("ATTRIBUTE_AND_CONDITION").addState("EVERYTHING_NEEDED")}),C("_panelValue"+o).removeClass("show"),i.search({param:e.createHql(i.controlMap)})}if("remove"==a){var s=0==r?{}:e.createHql(i.controlMap);i.search({param:s})}}}var w=i.$parent.$parent,U=999;if(i._attributes=[],i.controlMap={},i.addCondition=y,i.addQuery=N,i.clearQuery=I,i.closeInput=S,i.removeQuery=_,i.showInput=x,i.saveSearch=k,i.updateOperator=D,i.toggleEnum=E,i.saveQuery=!!u.saveQuery&&i.saveQuery,u.search||console.error('É necessário atribuir uma função para o atributo SEARCH. [search="foo()"]'),i.$on("filter-items",function(t,a){var l=JSON.parse(a.value);i.controlMap={},JSON.parse(l.source).forEach(function(e,t){i.controlMap[t]=t%2==0?r.create(e,!0,"EVERYTHING_NEEDED",U--):r.create({value:e.value,label:"AND"===e.value?"E":"OU"},void 0,"EVERYTHING_NEEDED",U--)}),i.filterSelectItem=a,n(function(){return i.search({param:e.createHql(i.controlMap)})})}),i.getTextQuery=function(e){var t="valor";if(e.query.attribute){if(e.query.attribute.type&&"select"==e.query.attribute.type&&void 0!=e.query.value&&null!=e.query.value){var n=e.query.attribute.extraProperties.data.filter(function(t){return t.field==e.query.value});if(n.length>0)return n[0].label}t=l("gumgaGenericFilter")(e.query.value?e.query.value.push&&e.query.value.length>0?e.query.value.join(", "):e.query.value:"valor",e.query.attribute.type)}return t},i.$on("openOrCloseFilter",function(e,t){if(!t)return delete i.filterSelectItem,Object.keys(i.controlMap).forEach(function(e){var t=q(e);t.$value.active=!1,delete i.controlMap[e],n(function(e){return t.$destroy()})}),void i.search({param:{}});i.controlMap[0]||F()}),s(function(t){var n=i.$parent.$parent;[].slice.call(t).forEach(function(t,r){if("ADVANCED-SEARCH-FIELD"===t.nodeName){if(!t.getAttribute("field"))return console.error("É necessário atribuir um valor ao atributo FIELD da tag ADVANCED-SEARCH-FIELD.");var l=t.getAttribute("field"),o=t.getAttribute("type"),u=t.getAttribute("label")?a(t.getAttribute("label"))(n):l.charAt(0).toUpperCase().concat(l.slice(1)),c={};if(!o)return console.error("É necessário atribuir um valor ao atributo TYPE da tag ADVANCED-SEARCH-FIELD.");if(o=o.toLowerCase().trim()||"",u=u||l.charAt(0).toUpperCase()+l.slice(1),c=A(t),!e.useType(o))return console.error('O tipo "{1}" passado como parâmetro para o ADVANCED-SEARCH-FIELD não é suportado.'.replace("{1}",o));i._attributes.push({field:l,type:o,label:u,extraProperties:c})}})}),i._attributes[0]){var C=function(e){return angular.element(document.getElementById(e))},F=function(e){i.controlMap[0]=r.create({attribute:{},condition:{},value:""},!0,"NOTHING",U--),n(function(e){q().$value.removeState("NOTHING").addState("UPDATING_ATTRIBUTE")})};F();var G=angular.copy(i._attributes[0]);angular.copy(e.useType(G.type).defaultCondition)[0],i.addAttribute=d,i.toggleUpdatingAttribute=g,i.addCondition=y,i.toggleUpdatingCondition=f,i.toggleUpdatingValue=h,i.goSearch=p,i.callSearch=O,i.deleteFilter=v,i.isAnyQueryNotOk=m,i.lastOfControlMap=$,i.getIndexScope=q,i.validatonValue=T,document.addEventListener("click",function(e){O(e)}),document.addEventListener("keyup",function(e){27===e.keyCode&&Object.keys(i.controlMap).forEach(function(e){var t=q(e);8!==t.$value.activeStates&&(t.$$prevSibling.$key?(t.$$prevSibling.$value.active=!1,delete i.controlMap[t.$$prevSibling.$key],n(function(){return t.$$prevSibling.$destroy()})):t.$$nextSibling.$key?(t.$$nextSibling.$value.active=!1,delete i.controlMap[t.$$nextSibling.$key],n(function(){return t.$$nextSibling.$destroy()})):t.$$prevSibling.$key&&t.$$nextSibling.$key&&(t.$$nextSibling.$value.active=!1,delete i.controlMap[t.$$nextSibling.$key],n(function(){return t.$$nextSibling.$destroy()})),t.$value.active=!1,delete i.controlMap[e],n(function(e){return t.$destroy()}))})})}}}}a.$inject=["HQLFactory","$compile","$timeout","$interpolate","QueryModelFactory","$filter"],angular.module("gumga.queryfilter.filter.core",[]).directive("gumgaFilterCore",a)},function(e,t,n){"use strict";function a(e,t,n){return{restrict:"E",template:'\n    <div>\n      <button class="btn btn-default" ng-click="isOpen = !isOpen ">\n        <span class="glyphicon glyphicon-filter"></span>\n      </button>\n    </div>\n    <div id="replace"></div>\n    ',transclude:!0,scope:{search:"&",saveQuery:"&",containerId:"@?"},link:function(e,n,a,r,l){console.log("TESTE"),e.possibleAdvancedFields=[],e.search=e.search||angular.noop,e.saveQuery=e.saveQuery||angular.noop,e.containerId=e.containerId||"replace",e.proxySave=function(t){e.saveQuery({query:t,name:name})},e.proxySearch=function(t){e.search({param:t})},l(function(n){[].slice.call(n).forEach(function(t){t&&"ADVANCED-SEARCH-FIELD"===t.nodeName&&e.possibleAdvancedFields.push(t.outerHTML)});var r='<gumga-filter-core ng-show="isOpen" search="proxySearch(param)" '+(a.saveQuery?'save-query="saveQuery(query, name)"':"")+">\n                            "+e.possibleAdvancedFields.reduce(function(e,t){return e+=t},"")+"\n                          </gumga-filter-core>";angular.element(document.getElementById(e.containerId)).replaceWith(t(r)(e))})}}}a.$inject=["HQLFactory","$compile","$timeout"],angular.module("gumga.queryfilter.filter.directive",[]).directive("gumgaFilter",a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0),n(2),n(1);var a=angular.module("gumga.queryfilter",["gumga.queryfilter.query","gumga.queryfilter.filter","gumga.queryfilter.factory"]);t.default=a}]);